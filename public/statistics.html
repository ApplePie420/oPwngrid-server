<html>
    <head>
        <title>oPwngrid: Leaderboard</title>
        <script
            src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <script>
            //This is where most scripting will happen to get chart data and headers
            //Client side will do most of the formatting of data where the server will only do updates to its data every 10 minutes, this will decrease the work of the server

        $(document).ready(function() {
            $.get(`https://api.opwngrid.xyz/api/statistics/apsByDay?days=356`, function(data) {
            const ctx = document.getElementById('buildsChart');
            //FORMAT DATA
            days = []
            amount = []

            data.forEach(element => {
                days.push(element.day)
                amount.push(element.reported)
            });

            new Chart(ctx, {
              type: 'line',
              data: {
                labels: days,
                datasets: [{
                  label: '# of APs reported per day',
                  data: amount,
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: {
                    beginAtZero: true
                  }
                }
              }
            });

            })
        })
        </script>
    </head>
    <body style="font-family: Roboto;">
        <h1>Statistics</h1>
        <h2><a href="../">home</a> <a href="/convert">convert</a> <a
                href="/search/">search</a> <a href="/leaderboard">leaderboard</a>
            statistics</h2>
        <body>
            <form id="search-form">
                <input type="text" id="search-input"
                    placeholder="Search by fingerprint...">
                <button type="button" id="search-button">Search</button>
            </form>
            <script>
                // Get references to the input and button elements
                const searchInput = document.getElementById('search-input');
                const searchButton = document.getElementById('search-button');
        
                // Add a click event listener to the button
                searchButton.addEventListener('click', function () {
                    // Get the text from the input
                    const searchText = searchInput.value.trim();
        
                    // Check if the input is not empty
                    if (searchText) {
                        // Redirect to /search/ with the search query appended
                        window.location.href = `/search/${encodeURIComponent(searchText)}`;
                    }
                });
            </script>

            <!-- MAIN BODY BELOW-->

            <h2>At the moment this page is a work in progress. But it will start
                to have statics per build, versions and plugins most used and
                hopefully more user suggested information</h2>

            <div>
                <canvas id="buildsChart"></canvas>
            </div>

        </body>

    </html>